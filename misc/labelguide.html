<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ä½ç½®ã‚¬ã‚¤ãƒ‰ (ãƒ‰ãƒƒãƒˆã®ã¿)</title>
<style>
    body { margin: 0; padding: 0; background: #eee; font-family: sans-serif; color: #333; }

    /* ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒãƒ¼ */
    #controls {
        position: sticky; top: 0; background: #fff; border-bottom: 1px solid #ccc; padding: 10px 20px;
        display: flex; gap: 20px; align-items: center; z-index: 100;
        font-size: 0.9rem; flex-wrap: wrap;
    }
    .input-group { display: flex; align-items: center; gap: 5px; }
    input { width: 50px; padding: 5px; text-align: right; border: 1px solid #ccc; border-radius: 4px; }
    button { 
        padding: 6px 16px; cursor: pointer; font-weight: bold; 
        background: #333; color: white; border: none; border-radius: 4px; 
    }
    button:hover { background: #555; }

    /* ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¨ãƒªã‚¢ */
    #preview {
        padding: 40px; display: flex; flex-direction: column; align-items: center; gap: 30px;
    }

    /* ç”¨ç´™è¨­å®š (A4 ç¸¦) */
    @page { size: A4 portrait; margin: 0; }
    
    .sheet {
        width: 210mm; height: 297mm; background: white;
        position: relative; overflow: hidden;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        page-break-after: always;
    }

    /* ç‚¹ (ãƒ») ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    .dot {
        position: absolute;
        width: 2mm; height: 2mm;      /* å°ã•ã„ä¸¸ */
        background-color: #ccc;       /* è–„ã„ã‚°ãƒ¬ãƒ¼ */
        border-radius: 50%;           /* ä¸¸ãã™ã‚‹ */
        transform: translateY(-50%);  /* ä¸Šä¸‹ä¸­å¤®æƒãˆ */
        pointer-events: none;
    }

    /* å°åˆ·æ™‚ã®è¨­å®š */
    @media print {
        body { background: white; }
        #controls { display: none; }
        #preview { padding: 0; margin: 0; display: block; }
        .sheet { margin: 0; box-shadow: none; border: none; }
    }
</style>
</head>
<body>

<div id="controls">
    <div class="input-group">
        <label>ãƒšãƒ¼ã‚¸æ•°</label>
        <input type="number" id="totalPages" value="12" min="1" onchange="render()">
    </div>
    <div class="input-group">
        <label>å±±ã®æ•°</label>
        <input type="number" id="loopCount" value="12" min="1" onchange="render()">
    </div>
    <div class="input-group">
        <label>ãƒ©ãƒ™ãƒ«é«˜ã•(mm)</label>
        <input type="number" id="pitch" value="23" step="0.5" onchange="render()">
    </div>
    <div class="input-group">
        <label>é–‹å§‹ä½ç½®(mm)</label>
        <input type="number" id="startTop" value="0" min="0" onchange="render()">
    </div>
    <div class="input-group">
        <label>å³ã‹ã‚‰ã®è·é›¢(mm)</label>
        <input type="number" id="rightMargin" value="5" min="0" onchange="render()">
    </div>
    
    <div style="flex-grow:1"></div>
    <button onclick="window.print()">ğŸ–¨ å°åˆ·</button>
</div>

<div id="preview"></div>

<script>
window.onload = render;

function render() {
    const container = document.getElementById('preview');
    container.innerHTML = "";

    const totalPages = parseInt(document.getElementById('totalPages').value) || 1;
    const loopCount = parseInt(document.getElementById('loopCount').value) || 12;
    const pitch = parseFloat(document.getElementById('pitch').value) || 23;
    const startTop = parseFloat(document.getElementById('startTop').value) || 0;
    const rightMargin = parseFloat(document.getElementById('rightMargin').value) || 5;

    for (let i = 0; i < totalPages; i++) {
        const sheet = document.createElement('div');
        sheet.className = 'sheet';

        // ä½ç½®è¨ˆç®—: (ãƒšãƒ¼ã‚¸ç•ªå· % å±±ã®æ•°) -> 0, 1, 2...
        const posIndex = i % loopCount;
        
        // ä¸­å¿ƒåº§æ¨™: é–‹å§‹ä½ç½® + (å€‹æ•° * é«˜ã•) + (é«˜ã• / 2)
        const centerY = startTop + (posIndex * pitch) + (pitch / 2);

        const dot = document.createElement('div');
        dot.className = 'dot';
        
        // ä½ç½®åˆã‚ã›
        dot.style.top = centerY + 'mm'; 
        dot.style.right = rightMargin + 'mm'; // æŒ‡å®šã—ãŸãƒŸãƒªæ•°ã ã‘å†…å´ã¸

        sheet.appendChild(dot);
        container.appendChild(sheet);
    }
}
</script>
</body>
</html>
